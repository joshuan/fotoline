(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};$(function(){var b,c,d,e,f,g;return e=function(){function b(b,c){this.getHeight=a(this.getHeight,this),this.getWidth=a(this.getWidth,this),this.events=b,this.$el=$(c)}return b.prototype.events={},b.prototype.$el={},b.prototype.margin=0,b.prototype.getWidth=function(){return this.$el.width()},b.prototype.getHeight=function(){return this.$el.height()},b.prototype.setMargin=function(a){return this.margin=a,this.updateMargin(),this},b.prototype.updateMargin=function(){return this.$el.css({marginLeft:this.margin,marginRight:this.margin}),this},b}(),c=function(){function a(a,b){this.events=a,$.each(b,function(a){return function(b,c){a.addElement(c)}}(this)),this.events.on("fotoline.margin",function(a){return function(b,c){return a.setMargin(c),a}}(this))}return a.prototype.events={},a.prototype.elements=[],a.prototype.count=0,a.prototype.currentLeft=0,a.prototype.getCurrentLeft=function(){return this.currentLeft},a.prototype.next=function(){return this.currentLeft++,this.events.trigger("fotoline.update"),this},a.prototype.prev=function(){return this.currentLeft--,this.events.trigger("fotoline.update"),this},a.prototype.addElement=function(a){return this.elements.push(new e(this.events,a)),this.count++,this},a.prototype.getSize=function(){return this.count},a.prototype.setMargin=function(a){return $.each(this.elements,function(b){return function(c,d){return d.setMargin(a),b}}(this)),this},a.prototype.getItemWidth=function(){return this.elements[0].getWidth()},a.prototype.getItemHeight=function(){return this.elements[0].getHeight()},a.prototype.setWidth=function(a){return $.each(this.elements,function(b,c){return c.$el.width(a),this})},a}(),f=function(){function a(a,b,d,e){this.min_margin=d,this.max_margin=e,this.events=a,this.$row=b,this.collection=new c(a,b.children()),this.events.on("fotoline.resize",function(a){return function(){return a.size(),a}}(this)).on("fotoline.resize",function(a){return function(){return a.rowWidth(),a}}(this)).on("fotoline.resize",function(a){return function(){return a.update("css"),a}}(this)).on("fotoline.resize",function(a){return function(){return a.updateArrowStatus(),a}}(this)).on("<",function(a){return function(){return a.moveLeft(),a}}(this)).on(">",function(a){return function(){return a.moveRight(),a}}(this)).on("fotoline.update",function(a){return function(){return a.updateArrowStatus(),a}}(this)).on("fotoline.update",function(a){return function(){return a.update("animate"),a}}(this)),this.updateArrowStatus()}return a.prototype.events={},a.prototype.$row={},a.prototype.collection={},a.prototype.max_visible=0,a.prototype.current_visible=0,a.prototype.current_width=0,a.prototype.max_margin=999,a.prototype.min_margin=0,a.prototype.getCollection=function(){return this.collection},a.prototype.children=function(){return this.$row.children()},a.prototype.canLeft=function(){return this.collection.getCurrentLeft()<this.collection.count-this.current_visible},a.prototype.canRight=function(){return this.collection.getCurrentLeft()>0},a.prototype.moveLeft=function(){return this.canLeft()?this.collection.next():void 0},a.prototype.moveRight=function(){return this.canRight()?this.collection.prev():void 0},a.prototype.size=function(){var a,b,c,d,e,f;return c=this.collection.getItemWidth(),a=this.$row.parent(),f=a.parent().width(),b=this.collection.getSize(),this.max_visible=Math.floor(f/(c+2*this.min_margin)),this.current_visible=this.max_visible<b?this.max_visible:b,e=0,d=(f-c*this.current_visible)/this.current_visible/2,d>this.max_margin?(d=this.max_margin,e=(f-this.current_visible*(c+2*d))/2):d<this.min_margin&&(d=this.min_margin),this.current_width=c+2*d,a.css({marginLeft:e,marginRight:e}),this.events.trigger("fotoline.margin",[d]),this},a.prototype.update=function(a){var b,c;return b=this.collection.getCurrentLeft(),c=-b*this.current_width,a=a||"css",this.$row[a]({left:c}),this},a.prototype.rowWidth=function(){return this.$row.width(this.collection.getSize()*this.current_width),this},a.prototype.updateArrowStatus=function(){var a,b;return a=this.collection.getSize(),a<=this.max_visible?this.events.trigger("fotoline.visibleAll"):(this.events.trigger("fotoline.visibleSome"),b=this.collection.getCurrentLeft(),0===b?this.events.trigger("fotoline.visibleFirst"):this.events.trigger("fotoline.hidedFirst"),b>=a-this.max_visible?this.events.trigger("fotoline.visibleLast"):this.events.trigger("fotoline.hidedLast")),this},a}(),d=function(){function a(a){var c,d;this.events=a,this.$container=a,this.params(),this.wrap(),d=a.find('[data-fotoline-direct="prev"]'),c=a.find('[data-fotoline-direct="next"]'),this.parameters.Arrow?this.arrows=new b(this.events,d,c):(d.remove(),c.remove()),this.row=new f(this.events,a.find(".fotoline-row"),this.parameters.MinMargin,this.parameters.MaxMargin),this.collection=this.row.getCollection(),"thumbs"===this.parameters.Behavior&&new g(this.events,this.row,this.collection,this.parameters.Fotorama),this.height(),this.events.trigger("fotoline.resize"),$(window).on("resize",function(a){return function(){return a.events.trigger("fotoline.resize"),a}}(this))}return a.prototype.events={},a.prototype.$container={},a.prototype.row={},a.prototype.collection={},a.prototype.arrows={},a.prototype.defaults={Height:!1,Width:!1,Margin:10,Behavior:"none",MinMargin:1,MaxMargin:999,Arrow:!0,Fotorama:!1,NextArrow:"&lt;",PrevArrow:"&gt;"},a.prototype.parameters={},a.prototype.wrap=function(){var a,b;return a=this.$container.children(),b=[],a.each(function(){b.push('<div class="fotoline-item">'+$(this).html()+"</div>")}),this.$container.html('<div class="fotoline-wrap"> <div class="fotoline-arrow fotoline-arrow-left" data-fotoline-direct="next">&lt;</div> <div class="fotoline-container"> <div class="fotoline-jack"> <div class="fotoline-row">'+b.join("")+'</div> </div> </div> <div class="fotoline-arrow fotoline-arrow-right" data-fotoline-direct="prev">&gt;</div> </div>')},a.prototype.params=function(){var a;return a={},$.each(this.$container.data(),function(b,c){b=b.replace(/^fotoline/,""),a[b]=c}),this.parameters=$.extend({},this.defaults,a)},a.prototype.height=function(){var a,b;return b=this.parameters.Width?this.parameters.Width:this.collection.getItemWidth(),a=this.parameters.Height?this.parameters.Height:this.collection.getItemHeight(),a+=2*this.parameters.Margin,this.collection.setWidth(b),this.$container.find(".fotoline-wrap").height(a),this},a}(),b=function(){function b(b,c,d){this.unblock=a(this.unblock,this),this.block=a(this.block,this),this.events=b,this.$prev=c,this.$next=d,this.initEvents(),this.events.on("fotoline.visibleFirst",function(a){return function(){a.block("prev")}}(this)).on("fotoline.visibleLast",function(a){return function(){a.block("next")}}(this)).on("fotoline.hidedFirst",function(a){return function(){a.unblock("prev")}}(this)).on("fotoline.hidedLast",function(a){return function(){a.unblock("next")}}(this)).on("fotoline.visibleAll",function(a){return function(){a.hide()}}(this)).on("fotoline.visibleSome",function(a){return function(){a.show()}}(this))}return b.prototype.events={},b.prototype.$prev={},b.prototype.$next={},b.prototype.initEvents=function(){return this.$prev.on("click",function(a){return function(){return a.events.trigger("<"),!1}}(this)),this.$next.on("click",function(a){return function(){return a.events.trigger(">"),!1}}(this)),this},b.prototype.block=function(a){var b;return b="prev"===a?this.$next:this.$prev,b.addClass("fotoline-arrow-block"),this},b.prototype.unblock=function(a){var b;return b="prev"===a?this.$next:this.$prev,b.removeClass("fotoline-arrow-block"),this},b.prototype.hide=function(){return this.$prev.addClass("fotoline-arrow-hide"),this.$next.addClass("fotoline-arrow-hide"),this},b.prototype.show=function(){return this.$prev.removeClass("fotoline-arrow-hide"),this.$next.removeClass("fotoline-arrow-hide"),this},b}(),g=function(){function b(b,c,d,e){this.onClick=a(this.onClick,this),this.update=a(this.update,this),this.events=b,this.collection=d,this.row=c,this.$el=$("<div>",{"class":"fotoline-current"}),c.$row.append(this.$el),c.children().on("click",this.onClick),this.update(),this.events.on("fotoline.resize",function(a){return function(){a.update("css")}}(this)).on("fotoline.update",function(a){return function(){a.update()}}(this)).on("fotoline.margin",function(a){return function(b,c){setTimeout(function(){a.update("css")},500)}}(this)),e&&(this.fotorama=$(e),this.fotoramaInit())}return b.prototype.events={},b.prototype.$el={},b.prototype.collection={},b.prototype.row={},b.prototype.current=0,b.prototype.fotorama={},b.prototype.fotoramaApi={},b.prototype.update=function(a){var b,c,d,e;return null==a&&(a="animate"),b=this.collection.elements[this.current],d=b.$el.position(),e=b.$el.width(),c=b.$el.height(),$.each(this.collection.elements,function(a,b){b.$el.removeClass("active")}),b.$el.addClass("active"),this.$el[a]({width:e,height:c,left:d.left+b.margin,top:d.top}),this},b.prototype.onClick=function(a){var b,c;return b=$(a.currentTarget).index(),this.current=b,c=this.calcLeft(this.current),this.collection.currentLeft=c,this.events.trigger("fotoline.update"),!1},b.prototype.calcLeft=function(a){var b,c,d;return d=this.row.current_visible,b=this.collection.count,c=d%2===0?a-d/2+1:a-Math.floor(d/2),0>c?c=0:c>b-d&&(c=b-d),c},b.prototype.fotoramaInit=function(){this.events.on("fotoline.update",function(a){return function(){var b;b=a.fotorama.data("fotorama"),a.current!==b.activeIndex&&b.show(a.current)}}(this)),this.fotorama.on("fotorama:show",function(a){return function(b,c,d){a.current!==c.activeIndex&&(a.current=c.activeIndex,a.collection.currentLeft=a.calcLeft(a.current),a.events.trigger("fotoline.update"))}}(this))},b}(),$(".fotoline").each(function(){var a,b;a=$(this),b=new d(a),a.data({fotoline:b})}),this})}).call(this);